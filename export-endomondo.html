<a href="javascript:(function()%7Bfunction createURL(e%2Co)%7Be%2B%3D"T01%253A00%253A00.000Z"%2Co%2B%3D"T23%253A59%253A59.000Z"%3Bvar t%3D"https%3A%2F%2Fwww.endomondo.com%2Frest%2Fv1%2Fusers%2F"%2Buser%2B"%2Fworkouts%3Fbefore%3D"%2Bo%2B"%26after%3D"%2Be%3Breturn t%7Dfunction getUser()%7Bvar e%3D%2Fusers%5C%2F(.*)%5C%2Fworkouts%2F.exec(location.href)%7C%7C%5B%5D%3Breturn 2!%3De.length%3F(alert("User has not beed detected. Please run this bookmarklet from the 'Training' page.")%2Cnull)%3Ae%5B1%5D%7Dfunction GET(e%2Co)%7Bvar t%3Dnew XMLHttpRequest%3Bt.onreadystatechange%3Dfunction()%7B4%3D%3D%3Dt.readyState%26%26o(t.responseText)%7D%2Ct.open("GET"%2Ce%2C!0)%2Ct.send()%7Dfunction getWorkouts(e%2Co)%7BGET(e%2Cfunction(e)%7Bo(extractAllIds(JSON.parse(e)))%7D)%7Dfunction extractAllIds(e)%7Bfor(var o%3D%5B%5D%2Ct%3D0%3Be.length>t%3B%2B%2Bt)o.push(e%5Bt%5D.id)%3Breturn o%7Dfunction onWorkouts(e)%7Bfunction o(e)%7Bvar o%3Ddocument.createElement("a")%3Bo.innerHTML%3D"download track"%2Co.href%3D"https%3A%2F%2Fwww.endomondo.com%2Frest%2Fv1%2Fusers%2F"%2Buser%2B"%2Fworkouts%2F"%2Be%2B"%2Fexport%3Fformat%3DGPX"%2Co.className%3D"endodownload"%2Co.style.display%3D"block"%2Co.target%3D"_blank"%2Cdocument.body.appendChild(o)%7Dfor(var t%3D0%3Be.length>t%3B%2B%2Bt)o(e%5Bt%5D)%3BdownloadAll()%7Dfunction downloadAll()%7Bfunction e(o)%7Bif(0%3D%3Do.length)return console.log("download completed")%2Cvoid 0%3Bconsole.log("downloading track...s")%3Bvar t%3Do%5B0%5D%3Bt.click()%2CsetTimeout(function()%7Be(o.slice(1))%7D%2C1e3)%7Dvar o%3Ddocument.getElementsByClassName("endodownload")%3Be(Array.prototype.slice.call(o))%7Dvar user%3DgetUser()%3Bif(null!%3Duser)%7Bvar year%3Dwindow.prompt("Insert the year you want to export (eg. 2015)")%2Curl%3DcreateURL(year%2B"-01-01"%2Cyear%2B"-12-31")%3BgetWorkouts(url%2ConWorkouts)%7D%7D)()">Export Endo mondo Tracks!</a>
